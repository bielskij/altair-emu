			;***********************************************************************
			; MICROCOSM ASSOCIATES  8080/8085 CPU DIAGNOSTIC VERSION 1.0  (C) 1980
			;***********************************************************************
			;
			;DONATED TO THE "SIG/M" CP/M USER'S GROUP BY:
			;KELLY SMITH, MICROCOSM ASSOCIATES
			;3055 WACO AVENUE
			;SIMI VALLEY, CALIFORNIA, 93065
			;(805) 527-9321 (MODEM, CP/M-NET (TM))
			;(805) 527-0518 (VERBAL)
			;
			;
			;
			;
			;
			;
			
            01 00			ORG	00100H
			;
			;
			;
    22 0100 C3 AF 01		JMP	CPU	;JUMP TO 8080 CPU DIAGNOSTIC
			;
			;
			;
    26 0103			DB	'MICROCOSM ASSOCIATES 8080/8085 CPU DIAGNOSTIC'
            4D 49 43 52 
            4F 43 4F 53 
            4D 20 41 53 
            53 4F 43 49 
            41 54 45 53 
            20 38 30 38 
            30 2F 38 30 
            38 35 20 43 
            50 55 20 44 
            49 41 47 4E 
            4F 53 54 49 
            43 
    27 0130			DB	' VERSION 1.0  (C) 1980'
            20 56 45 52 
            53 49 4F 4E 
            20 31 2E 30 
            20 20 28 43 
            29 20 31 39 
            38 30 
			;
			;
			;
            00 05	BDOS	EQU	00005H	;BDOS ENTRY TO CP/M
            00 00	WBOOT	EQU	00000H	;RE-ENTRY TO CP/M WARM BOOT
			;
			;
			;
			;MESSAGE OUTPUT ROUTINE
			;
    38 0146 D5		MSG:	PUSH	D	;EXILE D REG.
    39 0147 EB			XCHG		;SWAP H&L REGS. TO D&E REGS.
    40 0148 0E 09		MVI	C,9	;LET BDOS KNOW WE WANT TO SEND A MESSAGE
    41 014A CD 05 00		CALL	BDOS
    42 014D D1			POP	D	;BACK FROM EXILE
    43 014E C9			RET
			;
			;
			;
			;CHARACTER OUTPUT ROUTINE
			;
    49 014F 0E 02	PCHAR:	MVI	C,2
    50 0151 CD 05 00		CALL	BDOS
    51 0154 C9			RET
			;
			;
			;
    55 0155 F5		BYTEO:	PUSH	PSW
    56 0156 CD 65 01		CALL	BYTO1
    57 0159 5F			MOV	E,A
    58 015A CD 4F 01		CALL	PCHAR
    59 015D F1			POP	PSW
    60 015E CD 69 01		CALL	BYTO2
    61 0161 5F			MOV	E,A
    62 0162 C3 4F 01		JMP	PCHAR
    63 0165 0F		BYTO1:	RRC
    64 0166 0F			RRC
    65 0167 0F			RRC
    66 0168 0F			RRC
    67 0169 E6 0F	BYTO2:	ANI	0FH
    68 016B FE 0A		CPI	0AH
    69 016D FA 72 01		JM	BYTO3
    70 0170 C6 07		ADI	7
    71 0172 C6 30	BYTO3:	ADI	30H
    72 0174 C9			RET
			;
			;
			;
			;************************************************************
			;           MESSAGE TABLE FOR OPERATIONAL CPU TEST
			;************************************************************
			;
    80 0175		OKCPU:	DB	0CH,0DH,0AH,' CPU IS OPERATIONAL$'
            0C 0D 0A 20 
            43 50 55 20 
            49 53 20 4F 
            50 45 52 41 
            54 49 4F 4E 
            41 4C 24 
			;
    82 018C		NGCPU:	DB	0CH,0DH,0AH,' CPU HAS FAILED!    ERROR EXIT=$'
            0C 0D 0A 20 
            43 50 55 20 
            48 41 53 20 
            46 41 49 4C 
            45 44 21 20 
            20 20 20 45 
            52 52 4F 52 
            20 45 58 49 
            54 3D 24 
			;
			;
			;
			;************************************************************
			;                8080/8085 CPU TEST/DIAGNOSTIC
			;************************************************************
			;
			;NOTE: (1) PROGRAM ASSUMES "CALL",AND "LXI SP" INSTRUCTIONS WORK!
			;
			;      (2) INSTRUCTIONS NOT TESTED ARE "HLT","DI","EI","RIM","SIM",
			;          AND "RST 0" THRU "RST 7"
			;
			;
			;
			;TEST JUMP INSTRUCTIONS AND FLAGS
			;
    99 01AF 31 A8 07	CPU:	LXI	SP,STACK	;SET THE STACK POINTER
   100 01B2 E6 00		ANI	0	;INITIALIZE A REG. AND CLEAR ALL FLAGS
   101 01B4 CA BA 01		JZ	J010	;TEST "JZ"
   102 01B7 CD 8D 06		CALL	CPUER
   103 01BA D2 C0 01	J010:	JNC	J020	;TEST "JNC"
   104 01BD CD 8D 06		CALL	CPUER
   105 01C0 EA C6 01	J020:	JPE	J030	;TEST "JPE"
   106 01C3 CD 8D 06		CALL	CPUER
   107 01C6 F2 CC 01	J030:	JP	J040	;TEST "JP"
   108 01C9 CD 8D 06		CALL	CPUER
   109 01CC C2 DB 01	J040:	JNZ	J050	;TEST "JNZ"
   110 01CF DA DB 01		JC	J050	;TEST "JC"
   111 01D2 E2 DB 01		JPO	J050	;TEST "JPO"
   112 01D5 FA DB 01		JM	J050	;TEST "JM"
   113 01D8 C3 DE 01		JMP	J060	;TEST "JMP" (IT'S A LITTLE LATE,BUT WHAT THE HELL!
   114 01DB CD 8D 06	J050:	CALL	CPUER
   115 01DE C6 06	J060:	ADI	6	;A=6,C=0,P=1,S=0,Z=0
   116 01E0 C2 E6 01		JNZ	J070	;TEST "JNZ"
   117 01E3 CD 8D 06		CALL	CPUER
   118 01E6 DA EF 01	J070:	JC	J080	;TEST "JC"
   119 01E9 E2 EF 01		JPO	J080	;TEST "JPO"
   120 01EC F2 F2 01		JP	J090	;TEST "JP"
   121 01EF CD 8D 06	J080:	CALL	CPUER
   122 01F2 C6 70	J090:	ADI	070H	;A=76H,C=0,P=0,S=0,Z=0
   123 01F4 E2 FA 01		JPO	J100	;TEST "JPO"
   124 01F7 CD 8D 06		CALL	CPUER
   125 01FA FA 03 02	J100:	JM	J110	;TEST "JM"
   126 01FD CA 03 02		JZ	J110	;TEST "JZ"
   127 0200 D2 06 02		JNC	J120	;TEST "JNC"
   128 0203 CD 8D 06	J110:	CALL	CPUER
   129 0206 C6 81	J120:	ADI	081H	;A=F7H,C=0,P=0,S=1,Z=0
   130 0208 FA 0E 02		JM	J130	;TEST "JM"
   131 020B CD 8D 06		CALL	CPUER
   132 020E CA 17 02	J130:	JZ	J140	;TEST "JZ"
   133 0211 DA 17 02		JC	J140	;TEST "JC"
   134 0214 E2 1A 02		JPO	J150	;TEST "JPO"
   135 0217 CD 8D 06	J140:	CALL	CPUER
   136 021A C6 FE	J150:	ADI	0FEH	;A=F5H,C=1,P=1,S=1,Z=0
   137 021C DA 22 02		JC	J160	;TEST "JC"
   138 021F CD 8D 06		CALL	CPUER
   139 0222 CA 2B 02	J160:	JZ	J170	;TEST "JZ"
   140 0225 E2 2B 02		JPO	J170	;TEST "JPO"
   141 0228 FA 2E 02		JM	AIMM	;TEST "JM"
   142 022B CD 8D 06	J170:	CALL	CPUER
			;
			;
			;
			;TEST ACCUMULATOR IMMEDIATE INSTRUCTIONS
			;
   148 022E FE 00	AIMM:	CPI	0	;A=F5H,C=0,Z=0
   149 0230 DA 46 02		JC	CPIE	;TEST "CPI" FOR RE-SET CARRY
   150 0233 CA 46 02		JZ	CPIE	;TEST "CPI" FOR RE-SET ZERO
   151 0236 FE F5		CPI	0F5H	;A=F5H,C=0,Z=1
   152 0238 DA 46 02		JC	CPIE	;TEST "CPI" FOR RE-SET CARRY ("ADI")
   153 023B C2 46 02		JNZ	CPIE	;TEST "CPI" FOR RE-SET ZERO
   154 023E FE FF		CPI	0FFH	;A=F5H,C=1,Z=0
   155 0240 CA 46 02		JZ	CPIE	;TEST "CPI" FOR RE-SET ZERO
   156 0243 DA 49 02		JC	ACII	;TEST "CPI" FOR SET CARRY
   157 0246 CD 8D 06	CPIE:	CALL	CPUER
   158 0249 CE 0A	ACII:	ACI	00AH	;A=F5H+0AH+CARRY(1)=0,C=1
   159 024B CE 0A		ACI	00AH	;A=0+0AH+CARRY(0)=0BH,C=0
   160 024D FE 0B		CPI	00BH
   161 024F CA 55 02		JZ	SUII	;TEST "ACI"
   162 0252 CD 8D 06		CALL	CPUER
   163 0255 D6 0C	SUII:	SUI	00CH	;A=FFH,C=0
   164 0257 D6 0F		SUI	00FH	;A=F0H,C=1
   165 0259 FE F0		CPI	0F0H
   166 025B CA 61 02		JZ	SBII	;TEST "SUI"
   167 025E CD 8D 06		CALL	CPUER
   168 0261 DE F1	SBII:	SBI	0F1H	;A=F0H-0F1H-CARRY(0)=FFH,C=1
   169 0263 DE 0E		SBI	00EH	;A=FFH-OEH-CARRY(1)=F0H,C=0
   170 0265 FE F0		CPI	0F0H
   171 0267 CA 6D 02		JZ	ANII	;TEST "SBI"
   172 026A CD 8D 06		CALL	CPUER
   173 026D E6 55	ANII:	ANI	055H	;A=F0H<AND>55H=50H,C=0,P=1,S=0,Z=0
   174 026F FE 50		CPI	050H
   175 0271 CA 77 02		JZ	ORII	;TEST "ANI"
   176 0274 CD 8D 06		CALL	CPUER
   177 0277 F6 3A	ORII:	ORI	03AH	;A=50H<OR>3AH=7AH,C=0,P=0,S=0,Z=0
   178 0279 FE 7A		CPI	07AH
   179 027B CA 81 02		JZ	XRII	;TEST "ORI"
   180 027E CD 8D 06		CALL	CPUER
   181 0281 EE 0F	XRII:	XRI	00FH	;A=7AH<XOR>0FH=75H,C=0,P=0,S=0,Z=0
   182 0283 FE 75		CPI	075H
   183 0285 CA 8B 02		JZ	C010	;TEST "XRI"
   184 0288 CD 8D 06		CALL	CPUER
			;
			;
			;
			;TEST CALLS AND RETURNS
			;
   190 028B E6 00	C010:	ANI	000H	;A=0,C=0,P=1,S=0,Z=1
   191 028D DC 8D 06		CC	CPUER	;TEST "CC"
   192 0290 E4 8D 06		CPO	CPUER	;TEST "CPO"
   193 0293 FC 8D 06		CM	CPUER	;TEST "CM"
   194 0296 C4 8D 06		CNZ	CPUER	;TEST "CNZ"
   195 0299 FE 00		CPI	000H
   196 029B CA A1 02		JZ	C020	;A=0,C=0,P=0,S=0,Z=1
   197 029E CD 8D 06		CALL	CPUER
   198 02A1 D6 77	C020:	SUI	077H	;A=89H,C=1,P=0,S=1,Z=0
   199 02A3 D4 8D 06		CNC	CPUER	;TEST "CNC"
   200 02A6 EC 8D 06		CPE	CPUER	;TEST "CPE"
   201 02A9 F4 8D 06		CP	CPUER	;TEST "CP"
   202 02AC CC 8D 06		CZ	CPUER	;TEST "CZ"
   203 02AF FE 89		CPI	089H
   204 02B1 CA B7 02		JZ	C030	;TEST FOR "CALLS" TAKING BRANCH
   205 02B4 CD 8D 06		CALL	CPUER
   206 02B7 E6 FF	C030:	ANI	0FFH	;SET FLAGS BACK!
   207 02B9 E4 C4 02		CPO	CPOI	;TEST "CPO"
   208 02BC FE D9		CPI	0D9H
   209 02BE CA 21 03		JZ	MOVI	;TEST "CALL" SEQUENCE SUCCESS
   210 02C1 CD 8D 06		CALL	CPUER
   211 02C4 E8		CPOI:	RPE		;TEST "RPE"
   212 02C5 C6 10		ADI	010H	;A=99H,C=0,P=0,S=1,Z=0
   213 02C7 EC D0 02		CPE	CPEI	;TEST "CPE"
   214 02CA C6 02		ADI	002H	;A=D9H,C=0,P=0,S=1,Z=0
   215 02CC E0			RPO		;TEST "RPO"
   216 02CD CD 8D 06		CALL	CPUER
   217 02D0 E0		CPEI:	RPO		;TEST "RPO"
   218 02D1 C6 20		ADI	020H	;A=B9H,C=0,P=0,S=1,Z=0
   219 02D3 FC DC 02		CM	CMI	;TEST "CM"
   220 02D6 C6 04		ADI	004H	;A=D7H,C=0,P=1,S=1,Z=0
   221 02D8 E8			RPE		;TEST "RPE"
   222 02D9 CD 8D 06		CALL	CPUER
   223 02DC F0		CMI:	RP		;TEST "RP"
   224 02DD C6 80		ADI	080H	;A=39H,C=1,P=1,S=0,Z=0
   225 02DF F4 E8 02		CP	TCPI	;TEST "CP"
   226 02E2 C6 80		ADI	080H	;A=D3H,C=0,P=0,S=1,Z=0
   227 02E4 F8			RM		;TEST "RM"
   228 02E5 CD 8D 06		CALL	CPUER
   229 02E8 F8		TCPI:	RM		;TEST "RM"
   230 02E9 C6 40		ADI	040H	;A=79H,C=0,P=0,S=0,Z=0
   231 02EB D4 F4 02		CNC	CNCI	;TEST "CNC"
   232 02EE C6 40		ADI	040H	;A=53H,C=0,P=1,S=0,Z=0
   233 02F0 F0			RP		;TEST "RP"
   234 02F1 CD 8D 06		CALL	CPUER
   235 02F4 D8		CNCI:	RC		;TEST "RC"
   236 02F5 C6 8F		ADI	08FH	;A=08H,C=1,P=0,S=0,Z=0
   237 02F7 DC 00 03		CC	CCI	;TEST "CC"
   238 02FA D6 02		SUI	002H	;A=13H,C=0,P=0,S=0,Z=0
   239 02FC D0			RNC		;TEST "RNC"
   240 02FD CD 8D 06		CALL	CPUER
   241 0300 D0		CCI:	RNC		;TEST "RNC"
   242 0301 C6 F7		ADI	0F7H	;A=FFH,C=0,P=1,S=1,Z=0
   243 0303 C4 0C 03		CNZ	CNZI	;TEST "CNZ"
   244 0306 C6 FE		ADI	0FEH	;A=15H,C=1,P=0,S=0,Z=0
   245 0308 D8			RC		;TEST "RC"
   246 0309 CD 8D 06		CALL	CPUER
   247 030C C8		CNZI:	RZ		;TEST "RZ"
   248 030D C6 01		ADI	001H	;A=00H,C=1,P=1,S=0,Z=1
   249 030F CC 18 03		CZ	CZI	;TEST "CZ"
   250 0312 C6 D0		ADI	0D0H	;A=17H,C=1,P=1,S=0,Z=0
   251 0314 C0			RNZ		;TEST "RNZ"
   252 0315 CD 8D 06		CALL	CPUER
   253 0318 C0		CZI:	RNZ		;TEST "RNZ"
   254 0319 C6 47		ADI	047H	;A=47H,C=0,P=1,S=0,Z=0
   255 031B FE 47		CPI	047H	;A=47H,C=0,P=1,S=0,Z=1
   256 031D C8			RZ		;TEST "RZ"
   257 031E CD 8D 06		CALL	CPUER
			;
			;
			;
			;TEST "MOV","INR",AND "DCR" INSTRUCTIONS
			;
   263 0321 3E 77	MOVI:	MVI	A,077H
   264 0323 3C			INR	A
   265 0324 47			MOV	B,A
   266 0325 04			INR	B
   267 0326 48			MOV	C,B
   268 0327 0D			DCR	C
   269 0328 51			MOV	D,C
   270 0329 5A			MOV	E,D
   271 032A 63			MOV	H,E
   272 032B 6C			MOV	L,H
   273 032C 7D			MOV	A,L	;TEST "MOV" A,L,H,E,D,C,B,A
   274 032D 3D			DCR	A
   275 032E 4F			MOV	C,A
   276 032F 59			MOV	E,C
   277 0330 6B			MOV	L,E
   278 0331 45			MOV	B,L
   279 0332 50			MOV	D,B
   280 0333 62			MOV	H,D
   281 0334 7C			MOV	A,H	;TEST "MOV" A,H,D,B,L,E,C,A
   282 0335 57			MOV	D,A
   283 0336 14			INR	D
   284 0337 6A			MOV	L,D
   285 0338 4D			MOV	C,L
   286 0339 0C			INR	C
   287 033A 61			MOV	H,C
   288 033B 44			MOV	B,H
   289 033C 05			DCR	B
   290 033D 58			MOV	E,B
   291 033E 7B			MOV	A,E	;TEST "MOV" A,E,B,H,C,L,D,A
   292 033F 5F			MOV	E,A
   293 0340 1C			INR	E
   294 0341 43			MOV	B,E
   295 0342 60			MOV	H,B
   296 0343 24			INR	H
   297 0344 4C			MOV	C,H
   298 0345 69			MOV	L,C
   299 0346 55			MOV	D,L
   300 0347 15			DCR	D
   301 0348 7A			MOV	A,D	;TEST "MOV" A,D,L,C,H,B,E,A
   302 0349 67			MOV	H,A
   303 034A 25			DCR	H
   304 034B 54			MOV	D,H
   305 034C 42			MOV	B,D
   306 034D 68			MOV	L,B
   307 034E 2C			INR	L
   308 034F 5D			MOV	E,L
   309 0350 1D			DCR	E
   310 0351 4B			MOV	C,E
   311 0352 79			MOV	A,C	;TEST "MOV" A,C,E,L,B,D,H,A
   312 0353 6F			MOV	L,A
   313 0354 2D			DCR	L
   314 0355 65			MOV	H,L
   315 0356 5C			MOV	E,H
   316 0357 53			MOV	D,E
   317 0358 4A			MOV	C,D
   318 0359 41			MOV	B,C
   319 035A 78			MOV	A,B
   320 035B FE 77		CPI	077H
   321 035D C4 8D 06		CNZ	CPUER	;TEST "MOV" A,B,C,D,E,H,L,A
			;
			;
			;
			;TEST ARITHMETIC AND LOGIC INSTRUCTIONS
			;
   327 0360 AF			XRA	A
   328 0361 06 01		MVI	B,001H
   329 0363 0E 03		MVI	C,003H
   330 0365 16 07		MVI	D,007H
   331 0367 1E 0F		MVI	E,00FH
   332 0369 26 1F		MVI	H,01FH
   333 036B 2E 3F		MVI	L,03FH
   334 036D 80			ADD	B
   335 036E 81			ADD	C
   336 036F 82			ADD	D
   337 0370 83			ADD	E
   338 0371 84			ADD	H
   339 0372 85			ADD	L
   340 0373 87			ADD	A
   341 0374 FE F0		CPI	0F0H
   342 0376 C4 8D 06		CNZ	CPUER	;TEST "ADD" B,C,D,E,H,L,A
   343 0379 90			SUB	B
   344 037A 91			SUB	C
   345 037B 92			SUB	D
   346 037C 93			SUB	E
   347 037D 94			SUB	H
   348 037E 95			SUB	L
   349 037F FE 78		CPI	078H
   350 0381 C4 8D 06		CNZ	CPUER	;TEST "SUB" B,C,D,E,H,L
   351 0384 97			SUB	A
   352 0385 C4 8D 06		CNZ	CPUER	;TEST "SUB" A
   353 0388 3E 80		MVI	A,080H
   354 038A 87			ADD	A
   355 038B 06 01		MVI	B,001H
   356 038D 0E 02		MVI	C,002H
   357 038F 16 03		MVI	D,003H
   358 0391 1E 04		MVI	E,004H
   359 0393 26 05		MVI	H,005H
   360 0395 2E 06		MVI	L,006H
   361 0397 88			ADC	B
   362 0398 06 80		MVI	B,080H
   363 039A 80			ADD	B
   364 039B 80			ADD	B
   365 039C 89			ADC	C
   366 039D 80			ADD	B
   367 039E 80			ADD	B
   368 039F 8A			ADC	D
   369 03A0 80			ADD	B
   370 03A1 80			ADD	B
   371 03A2 8B			ADC	E
   372 03A3 80			ADD	B
   373 03A4 80			ADD	B
   374 03A5 8C			ADC	H
   375 03A6 80			ADD	B
   376 03A7 80			ADD	B
   377 03A8 8D			ADC	L
   378 03A9 80			ADD	B
   379 03AA 80			ADD	B
   380 03AB 8F			ADC	A
   381 03AC FE 37		CPI	037H
   382 03AE C4 8D 06		CNZ	CPUER	;TEST "ADC" B,C,D,E,H,L,A
   383 03B1 3E 80		MVI	A,080H
   384 03B3 87			ADD	A
   385 03B4 06 01		MVI	B,001H
   386 03B6 98			SBB	B
   387 03B7 06 FF		MVI	B,0FFH
   388 03B9 80			ADD	B
   389 03BA 99			SBB	C
   390 03BB 80			ADD	B
   391 03BC 9A			SBB	D
   392 03BD 80			ADD	B
   393 03BE 9B			SBB	E
   394 03BF 80			ADD	B
   395 03C0 9C			SBB	H
   396 03C1 80			ADD	B
   397 03C2 9D			SBB	L
   398 03C3 FE E0		CPI	0E0H
   399 03C5 C4 8D 06		CNZ	CPUER	;TEST "SBB" B,C,D,E,H,L
   400 03C8 3E 80		MVI	A,080H
   401 03CA 87			ADD	A
   402 03CB 9F			SBB	A
   403 03CC FE FF		CPI	0FFH
   404 03CE C4 8D 06		CNZ	CPUER	;TEST "SBB" A
   405 03D1 3E FF		MVI	A,0FFH
   406 03D3 06 FE		MVI	B,0FEH
   407 03D5 0E FC		MVI	C,0FCH
   408 03D7 16 EF		MVI	D,0EFH
   409 03D9 1E 7F		MVI	E,07FH
   410 03DB 26 F4		MVI	H,0F4H
   411 03DD 2E BF		MVI	L,0BFH
   412 03DF A7			ANA	A
   413 03E0 A1			ANA	C
   414 03E1 A2			ANA	D
   415 03E2 A3			ANA	E
   416 03E3 A4			ANA	H
   417 03E4 A5			ANA	L
   418 03E5 A7			ANA	A
   419 03E6 FE 24		CPI	024H
   420 03E8 C4 8D 06		CNZ	CPUER	;TEST "ANA" B,C,D,E,H,L,A
   421 03EB AF			XRA	A
   422 03EC 06 01		MVI	B,001H
   423 03EE 0E 02		MVI	C,002H
   424 03F0 16 04		MVI	D,004H
   425 03F2 1E 08		MVI	E,008H
   426 03F4 26 10		MVI	H,010H
   427 03F6 2E 20		MVI	L,020H
   428 03F8 B0			ORA	B
   429 03F9 B1			ORA	C
   430 03FA B2			ORA	D
   431 03FB B3			ORA	E
   432 03FC B4			ORA	H
   433 03FD B5			ORA	L
   434 03FE B7			ORA	A
   435 03FF FE 3F		CPI	03FH
   436 0401 C4 8D 06		CNZ	CPUER	;TEST "ORA" B,C,D,E,H,L,A
   437 0404 3E 00		MVI	A,000H
   438 0406 26 8F		MVI	H,08FH
   439 0408 2E 4F		MVI	L,04FH
   440 040A A8			XRA	B
   441 040B A9			XRA	C
   442 040C AA			XRA	D
   443 040D AB			XRA	E
   444 040E AC			XRA	H
   445 040F AD			XRA	L
   446 0410 FE CF		CPI	0CFH
   447 0412 C4 8D 06		CNZ	CPUER	;TEST "XRA" B,C,D,E,H,L
   448 0415 AF			XRA	A
   449 0416 C4 8D 06		CNZ	CPUER	;TEST "XRA" A
   450 0419 06 44		MVI	B,044H
   451 041B 0E 45		MVI	C,045H
   452 041D 16 46		MVI	D,046H
   453 041F 1E 47		MVI	E,047H
   454 0421 26 06		MVI	H,(TEMP0 / 0FFH)	;HIGH BYTE OF TEST MEMORY LOCATION
   455 0423 2E AA		MVI	L,(TEMP0 AND 0FFH)	;LOW BYTE OF TEST MEMORY LOCATION
   456 0425 70			MOV	M,B
   457 0426 06 00		MVI	B,000H
   458 0428 46			MOV	B,M
   459 0429 3E 44		MVI	A,044H
   460 042B B8			CMP	B
   461 042C C4 8D 06		CNZ	CPUER	;TEST "MOV" M,B AND B,M
   462 042F 72			MOV	M,D
   463 0430 16 00		MVI	D,000H
   464 0432 56			MOV	D,M
   465 0433 3E 46		MVI	A,046H
   466 0435 BA			CMP	D
   467 0436 C4 8D 06		CNZ	CPUER	;TEST "MOV" M,D AND D,M
   468 0439 73			MOV	M,E
   469 043A 1E 00		MVI	E,000H
   470 043C 5E			MOV	E,M
   471 043D 3E 47		MVI	A,047H
   472 043F BB			CMP	E
   473 0440 C4 8D 06		CNZ	CPUER	;TEST "MOV" M,E AND E,M
   474 0443 74			MOV	M,H
   475 0444 26 06		MVI	H,(TEMP0 / 0FFH)
   476 0446 2E AA		MVI	L,(TEMP0 AND 0FFH)
   477 0448 66			MOV	H,M
   478 0449 3E 06		MVI	A,(TEMP0 / 0FFH)
   479 044B BC			CMP	H
   480 044C C4 8D 06		CNZ	CPUER	;TEST "MOV" M,H AND H,M
   481 044F 75			MOV	M,L
   482 0450 26 06		MVI	H,(TEMP0 / 0FFH)
   483 0452 2E AA		MVI	L,(TEMP0 AND 0FFH)
   484 0454 6E			MOV	L,M
   485 0455 3E AA		MVI	A,(TEMP0 AND 0FFH)
   486 0457 BD			CMP	L
   487 0458 C4 8D 06		CNZ	CPUER	;TEST "MOV" M,L AND L,M
   488 045B 26 06		MVI	H,(TEMP0 / 0FFH)
   489 045D 2E AA		MVI	L,(TEMP0 AND 0FFH)
   490 045F 3E 32		MVI	A,032H
   491 0461 77			MOV	M,A
   492 0462 BE			CMP	M
   493 0463 C4 8D 06		CNZ	CPUER	;TEST "MOV" M,A
   494 0466 86			ADD	M
   495 0467 FE 64		CPI	064H
   496 0469 C4 8D 06		CNZ	CPUER	;TEST "ADD" M
   497 046C AF			XRA	A
   498 046D 7E			MOV	A,M
   499 046E FE 32		CPI	032H
   500 0470 C4 8D 06		CNZ	CPUER	;TEST "MOV" A,M
   501 0473 26 06		MVI	H,(TEMP0 / 0FFH)
   502 0475 2E AA		MVI	L,(TEMP0 AND 0FFH)
   503 0477 7E			MOV	A,M
   504 0478 96			SUB	M
   505 0479 C4 8D 06		CNZ	CPUER	;TEST "SUB" M
   506 047C 3E 80		MVI	A,080H
   507 047E 87			ADD	A
   508 047F 8E			ADC	M
   509 0480 FE 33		CPI	033H
   510 0482 C4 8D 06		CNZ	CPUER	;TEST "ADC" M
   511 0485 3E 80		MVI	A,080H
   512 0487 87			ADD	A
   513 0488 9E			SBB	M
   514 0489 FE CD		CPI	0CDH
   515 048B C4 8D 06		CNZ	CPUER	;TEST "SBB" M
   516 048E A6			ANA	M
   517 048F C4 8D 06		CNZ	CPUER	;TEST "ANA" M
   518 0492 3E 25		MVI	A,025H
   519 0494 B6			ORA	M
   520 0495 FE 37		CPI	037H
   521 0497 C4 8D 06		CNZ	CPUER	;TEST "ORA" M
   522 049A AE			XRA	M
   523 049B FE 05		CPI	005H
   524 049D C4 8D 06		CNZ	CPUER	;TEST "XRA" M
   525 04A0 36 55		MVI	M,055H
   526 04A2 34			INR	M
   527 04A3 35			DCR	M
   528 04A4 86			ADD	M
   529 04A5 FE 5A		CPI	05AH
   530 04A7 C4 8D 06		CNZ	CPUER	;TEST "INR","DCR",AND "MVI" M
   531 04AA 01 FF 12		LXI	B,12FFH
   532 04AD 11 FF 12		LXI	D,12FFH
   533 04B0 21 FF 12		LXI	H,12FFH
   534 04B3 03			INX	B
   535 04B4 13			INX	D
   536 04B5 23			INX	H
   537 04B6 3E 13		MVI	A,013H
   538 04B8 B8			CMP	B
   539 04B9 C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" B
   540 04BC BA			CMP	D
   541 04BD C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" D
   542 04C0 BC			CMP	H
   543 04C1 C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" H
   544 04C4 3E 00		MVI	A,000H
   545 04C6 B9			CMP	C
   546 04C7 C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" B
   547 04CA BB			CMP	E
   548 04CB C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" D
   549 04CE BD			CMP	L
   550 04CF C4 8D 06		CNZ	CPUER	;TEST "LXI" AND "INX" H
   551 04D2 0B			DCX	B
   552 04D3 1B			DCX	D
   553 04D4 2B			DCX	H
   554 04D5 3E 12		MVI	A,012H
   555 04D7 B8			CMP	B
   556 04D8 C4 8D 06		CNZ	CPUER	;TEST "DCX" B
   557 04DB BA			CMP	D
   558 04DC C4 8D 06		CNZ	CPUER	;TEST "DCX" D
   559 04DF BC			CMP	H
   560 04E0 C4 8D 06		CNZ	CPUER	;TEST "DCX" H
   561 04E3 3E FF		MVI	A,0FFH
   562 04E5 B9			CMP	C
   563 04E6 C4 8D 06		CNZ	CPUER	;TEST "DCX" B
   564 04E9 BB			CMP	E
   565 04EA C4 8D 06		CNZ	CPUER	;TEST "DCX" D
   566 04ED BD			CMP	L
   567 04EE C4 8D 06		CNZ	CPUER	;TEST "DCX" H
   568 04F1 32 AA 06		STA	TEMP0
   569 04F4 AF			XRA	A
   570 04F5 3A AA 06		LDA	TEMP0
   571 04F8 FE FF		CPI	0FFH
   572 04FA C4 8D 06		CNZ	CPUER	;TEST "LDA" AND "STA"
   573 04FD 2A A8 06		LHLD	TEMPP
   574 0500 22 AA 06		SHLD	TEMP0
   575 0503 3A A8 06		LDA	TEMPP
   576 0506 47			MOV	B,A
   577 0507 3A AA 06		LDA	TEMP0
   578 050A B8			CMP	B
   579 050B C4 8D 06		CNZ	CPUER	;TEST "LHLD" AND "SHLD"
   580 050E 3A A9 06		LDA	TEMPP+1
   581 0511 47			MOV	B,A
   582 0512 3A AB 06		LDA	TEMP0+1
   583 0515 B8			CMP	B
   584 0516 C4 8D 06		CNZ	CPUER	;TEST "LHLD" AND "SHLD"
   585 0519 3E AA		MVI	A,0AAH
   586 051B 32 AA 06		STA	TEMP0
   587 051E 44			MOV	B,H
   588 051F 4D			MOV	C,L
   589 0520 AF			XRA	A
   590 0521 0A			LDAX	B
   591 0522 FE AA		CPI	0AAH
   592 0524 C4 8D 06		CNZ	CPUER	;TEST "LDAX" B
   593 0527 3C			INR	A
   594 0528 02			STAX	B
   595 0529 3A AA 06		LDA	TEMP0
   596 052C FE AB		CPI	0ABH
   597 052E C4 8D 06		CNZ	CPUER	;TEST "STAX" B
   598 0531 3E 77		MVI	A,077H
   599 0533 32 AA 06		STA	TEMP0
   600 0536 2A A8 06		LHLD	TEMPP
   601 0539 11 00 00		LXI	D,00000H
   602 053C EB			XCHG
   603 053D AF			XRA	A
   604 053E 1A			LDAX	D
   605 053F FE 77		CPI	077H
   606 0541 C4 8D 06		CNZ	CPUER	;TEST "LDAX" D AND "XCHG"
   607 0544 AF			XRA	A
   608 0545 84			ADD	H
   609 0546 85			ADD	L
   610 0547 C4 8D 06		CNZ	CPUER	;TEST "XCHG"
   611 054A 3E CC		MVI	A,0CCH
   612 054C 12			STAX	D
   613 054D 3A AA 06		LDA	TEMP0
   614 0550 FE CC		CPI	0CCH
   615 0552 12			STAX	D
   616 0553 3A AA 06		LDA	TEMP0
   617 0556 FE CC		CPI	0CCH
   618 0558 C4 8D 06		CNZ	CPUER	;TEST "STAX" D
   619 055B 21 77 77		LXI	H,07777H
   620 055E 29			DAD	H
   621 055F 3E EE		MVI	A,0EEH
   622 0561 BC			CMP	H
   623 0562 C4 8D 06		CNZ	CPUER	;TEST "DAD" H
   624 0565 BD			CMP	L
   625 0566 C4 8D 06		CNZ	CPUER	;TEST "DAD" H
   626 0569 21 55 55		LXI	H,05555H
   627 056C 01 FF FF		LXI	B,0FFFFH
   628 056F 09			DAD	B
   629 0570 3E 55		MVI	A,055H
   630 0572 D4 8D 06		CNC	CPUER	;TEST "DAD" B
   631 0575 BC			CMP	H
   632 0576 C4 8D 06		CNZ	CPUER	;TEST "DAD" B
   633 0579 3E 54		MVI	A,054H
   634 057B BD			CMP	L
   635 057C C4 8D 06		CNZ	CPUER	;TEST "DAD" B
   636 057F 21 AA AA		LXI	H,0AAAAH
   637 0582 11 33 33		LXI	D,03333H
   638 0585 19			DAD	D
   639 0586 3E DD		MVI	A,0DDH
   640 0588 BC			CMP	H
   641 0589 C4 8D 06		CNZ	CPUER	;TEST "DAD" D
   642 058C BD			CMP	L
   643 058D C4 8D 06		CNZ	CPUER	;TEST "DAD" B
   644 0590 37			STC
   645 0591 D4 8D 06		CNC	CPUER	;TEST "STC"
   646 0594 3F			CMC
   647 0595 DC 8D 06		CC	CPUER	;TEST "CMC
   648 0598 3E AA		MVI	A,0AAH
   649 059A 2F			CMA	
   650 059B FE 55		CPI	055H
   651 059D C4 8D 06		CNZ	CPUER	;TEST "CMA"
   652 05A0 B7			ORA	A	;RE-SET AUXILIARY CARRY
   653 05A1 27			DAA
   654 05A2 FE 55		CPI	055H
   655 05A4 C4 8D 06		CNZ	CPUER	;TEST "DAA"
   656 05A7 3E 88		MVI	A,088H
   657 05A9 87			ADD	A
   658 05AA 27			DAA
   659 05AB FE 76		CPI	076H
   660 05AD C4 8D 06		CNZ	CPUER	;TEST "DAA"
   661 05B0 AF			XRA	A
   662 05B1 3E AA		MVI	A,0AAH
   663 05B3 27			DAA
   664 05B4 D4 8D 06		CNC	CPUER	;TEST "DAA"
   665 05B7 FE 10		CPI	010H
   666 05B9 C4 8D 06		CNZ	CPUER	;TEST "DAA"
   667 05BC AF			XRA	A
   668 05BD 3E 9A		MVI	A,09AH
   669 05BF 27			DAA
   670 05C0 D4 8D 06		CNC	CPUER	;TEST "DAA"
   671 05C3 C4 8D 06		CNZ	CPUER	;TEST "DAA"
   672 05C6 37			STC
   673 05C7 3E 42		MVI	A,042H
   674 05C9 07			RLC
   675 05CA DC 8D 06		CC	CPUER	;TEST "RLC" FOR RE-SET CARRY
   676 05CD 07			RLC
   677 05CE D4 8D 06		CNC	CPUER	;TEST "RLC" FOR SET CARRY
   678 05D1 FE 09		CPI	009H
   679 05D3 C4 8D 06		CNZ	CPUER	;TEST "RLC" FOR ROTATION
   680 05D6 0F			RRC
   681 05D7 D4 8D 06		CNC	CPUER	;TEST "RRC" FOR SET CARRY
   682 05DA 0F			RRC
   683 05DB FE 42		CPI	042H
   684 05DD C4 8D 06		CNZ	CPUER	;TEST "RRC" FOR ROTATION
   685 05E0 17			RAL
   686 05E1 17			RAL
   687 05E2 D4 8D 06		CNC	CPUER	;TEST "RAL" FOR SET CARRY
   688 05E5 FE 08		CPI	008H
   689 05E7 C4 8D 06		CNZ	CPUER	;TEST "RAL" FOR ROTATION
   690 05EA 1F			RAR
   691 05EB 1F			RAR
   692 05EC DC 8D 06		CC	CPUER	;TEST "RAR" FOR RE-SET CARRY
   693 05EF FE 02		CPI	002H
   694 05F1 C4 8D 06		CNZ	CPUER	;TEST "RAR" FOR ROTATION
   695 05F4 01 34 12		LXI	B,01234H
   696 05F7 11 AA AA		LXI	D,0AAAAH
   697 05FA 21 55 55		LXI	H,05555H
   698 05FD AF			XRA	A
   699 05FE C5			PUSH	B
   700 05FF D5			PUSH	D
   701 0600 E5			PUSH	H
   702 0601 F5			PUSH	PSW
   703 0602 01 00 00		LXI	B,00000H
   704 0605 11 00 00		LXI	D,00000H
   705 0608 21 00 00		LXI	H,00000H
   706 060B 3E C0		MVI	A,0C0H
   707 060D C6 F0		ADI	0F0H
   708 060F F1			POP	PSW
   709 0610 E1			POP	H
   710 0611 D1			POP	D
   711 0612 C1			POP	B
   712 0613 DC 8D 06		CC	CPUER	;TEST "PUSH PSW" AND "POP PSW"
   713 0616 C4 8D 06		CNZ	CPUER	;TEST "PUSH PSW" AND "POP PSW"
   714 0619 E4 8D 06		CPO	CPUER	;TEST "PUSH PSW" AND "POP PSW"
   715 061C FC 8D 06		CM	CPUER	;TEST "PUSH PSW" AND "POP PSW"
   716 061F 3E 12		MVI	A,012H
   717 0621 B8			CMP	B
   718 0622 C4 8D 06		CNZ	CPUER	;TEST "PUSH B" AND "POP B"
   719 0625 3E 34		MVI	A,034H
   720 0627 B9			CMP	C
   721 0628 C4 8D 06		CNZ	CPUER	;TEST "PUSH B" AND "POP B"
   722 062B 3E AA		MVI	A,0AAH
   723 062D BA			CMP	D
   724 062E C4 8D 06		CNZ	CPUER	;TEST "PUSH D" AND "POP D"
   725 0631 BB			CMP	E
   726 0632 C4 8D 06		CNZ	CPUER	;TEST "PUSH D" AND "POP D"
   727 0635 3E 55		MVI	A,055H
   728 0637 BC			CMP	H
   729 0638 C4 8D 06		CNZ	CPUER	;TEST "PUSH H" AND "POP H"
   730 063B BD			CMP	L
   731 063C C4 8D 06		CNZ	CPUER	;TEST "PUSH H" AND "POP H"
   732 063F 21 00 00		LXI	H,00000H
   733 0642 39			DAD	SP
   734 0643 22 AF 06		SHLD	SAVSTK	;SAVE THE "OLD" STACK-POINTER!
   735 0646 31 AE 06		LXI	SP,TEMP4
   736 0649 3B			DCX	SP
   737 064A 3B			DCX	SP
   738 064B 33			INX	SP
   739 064C 3B			DCX	SP
   740 064D 3E 55		MVI	A,055H
   741 064F 32 AC 06		STA	TEMP2
   742 0652 2F			CMA
   743 0653 32 AD 06		STA	TEMP3
   744 0656 C1			POP	B
   745 0657 B8			CMP	B
   746 0658 C4 8D 06		CNZ	CPUER	;TEST "LXI","DAD","INX",AND "DCX" SP
   747 065B 2F			CMA
   748 065C B9			CMP	C
   749 065D C4 8D 06		CNZ	CPUER	;TEST "LXI","DAD","INX", AND "DCX" SP
   750 0660 21 AE 06		LXI	H,TEMP4
   751 0663 F9			SPHL
   752 0664 21 33 77		LXI	H,07733H
   753 0667 3B			DCX	SP
   754 0668 3B			DCX	SP
   755 0669 E3			XTHL
   756 066A 3A AD 06		LDA	TEMP3
   757 066D FE 77		CPI	077H
   758 066F C4 8D 06		CNZ	CPUER	;TEST "SPHL" AND "XTHL"
   759 0672 3A AC 06		LDA	TEMP2
   760 0675 FE 33		CPI	033H
   761 0677 C4 8D 06		CNZ	CPUER	;TEST "SPHL" AND "XTHL"
   762 067A 3E 55		MVI	A,055H
   763 067C BD			CMP	L
   764 067D C4 8D 06		CNZ	CPUER	;TEST "SPHL" AND "XTHL"
   765 0680 2F			CMA
   766 0681 BC			CMP	H
   767 0682 C4 8D 06		CNZ	CPUER	;TEST "SPHL" AND "XTHL"
   768 0685 2A AF 06		LHLD	SAVSTK	;RESTORE THE "OLD" STACK-POINTER
   769 0688 F9			SPHL
   770 0689 21 9F 06		LXI	H,CPUOK
   771 068C E9			PCHL		;TEST "PCHL"
			;
			;
			;
   775 068D 21 8C 01	CPUER:	LXI	H,NGCPU	;OUTPUT "CPU HAS FAILED    ERROR EXIT=" TO CONSOLE
   776 0690 CD 46 01		CALL	MSG
   777 0693 E3			XTHL
   778 0694 7C			MOV	A,H
   779 0695 CD 55 01		CALL	BYTEO	;SHOW ERROR EXIT ADDRESS HIGH BYTE
   780 0698 7D			MOV	A,L
   781 0699 CD 55 01		CALL	BYTEO	;SHOW ERROR EXIT ADDRESS LOW BYTE
   782 069C C3 00 00		JMP	WBOOT	;EXIT TO CP/M WARM BOOT
			;
			;
			;
   786 069F 21 75 01	CPUOK:	LXI	H,OKCPU	;OUTPUT "CPU IS OPERATIONAL" TO CONSOLE
   787 06A2 CD 46 01		CALL	MSG
   788 06A5 C3 00 00		JMP	WBOOT	;EXIT TO CP/M WARM BOOT
			;
			;
			;
   792 06A8		TEMPP:	DW	TEMP0	;POINTER USED TO TEST "LHLD","SHLD",
            AA06 
						; AND "LDAX" INSTRUCTIONS
			;
   795 06AA		TEMP0:	DS	1	;TEMPORARY STORAGE FOR CPU TEST MEMORY LOCATIONS
   796 06AB		TEMP1:	DS	1	;TEMPORARY STORAGE FOR CPU TEST MEMORY LOCATIONS
   797 06AC		TEMP2	DS	1	;TEMPORARY STORAGE FOR CPU TEST MEMORY LOCATIONS
   798 06AD		TEMP3:	DS	1	;TEMPORARY STORAGE FOR CPU TEST MEMORY LOCATIONS
   799 06AE		TEMP4:	DS	1	;TEMPORARY STORAGE FOR CPU TEST MEMORY LOCATIONS
   800 06AF		SAVSTK:	DS	2	;TEMPORARY STACK-POINTER STORAGE LOCATION
			;
			;
			;
            07 A8	STACK	EQU	TEMPP+256	;DE-BUG STACK POINTER STORAGE AREA
			;
			;
			;
				END


*******************************************************************************
                                 Symbols table
*******************************************************************************

Names		Types	Values
-----		-----	------
BDOS		EQU	00005h
WBOOT		EQU	00000h
STACK		EQU	007A8h
MSG		Label	00146h
PCHAR		Label	0014Fh
BYTEO		Label	00155h
BYTO1		Label	00165h
BYTO2		Label	00169h
BYTO3		Label	00172h
OKCPU		Label	00175h
NGCPU		Label	0018Ch
CPU		Label	001AFh
J010		Label	001BAh
J020		Label	001C0h
J030		Label	001C6h
J040		Label	001CCh
J050		Label	001DBh
J060		Label	001DEh
J070		Label	001E6h
J080		Label	001EFh
J090		Label	001F2h
J100		Label	001FAh
J110		Label	00203h
J120		Label	00206h
J130		Label	0020Eh
J140		Label	00217h
J150		Label	0021Ah
J160		Label	00222h
J170		Label	0022Bh
AIMM		Label	0022Eh
CPIE		Label	00246h
ACII		Label	00249h
SUII		Label	00255h
SBII		Label	00261h
ANII		Label	0026Dh
ORII		Label	00277h
XRII		Label	00281h
C010		Label	0028Bh
C020		Label	002A1h
C030		Label	002B7h
CPOI		Label	002C4h
CPEI		Label	002D0h
CMI		Label	002DCh
TCPI		Label	002E8h
CNCI		Label	002F4h
CCI		Label	00300h
CNZI		Label	0030Ch
CZI		Label	00318h
MOVI		Label	00321h
CPUER		Label	0068Dh
CPUOK		Label	0069Fh
TEMPP		Label	006A8h
TEMP0		Label	006AAh
TEMP1		Label	006ABh
TEMP2		Label	006ACh
TEMP3		Label	006ADh
TEMP4		Label	006AEh
SAVSTK		Label	006AFh

Statistics
----------
"Name"	= 0
"EQU"	= 3
"SET"	= 0
Labels	= 55


